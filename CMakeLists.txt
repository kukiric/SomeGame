cmake_minimum_required(VERSION 2.8.11)
project(SomeGame)
set(GAME_NAME ${PROJECT_NAME})
set(TOOLS_NAME DeveloperTools)
set(CMAKE_CXX_FLAGS "-std=c++11 -Wall -pedantic -g")
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/Bin)

option(BUILD_GAME "Build ${GAME_NAME}" ON)
option(BUILD_TOOLS "Build ${TOOLS_NAME}" OFF)

if(BUILD_GAME)
    file(GLOB_RECURSE SOURCE_LIST "Source/*.cpp" "Source/*.h")
    message(STATUS "Including non-source files in build. This should not cause any side effects.")
    file(GLOB_RECURSE MISC_LIST "*.cfg" "*.vert" "*.frag" "Data/*.txt")
    include_directories("Source")

    if(WIN32)
        set(LIBS mingw32 SDL2main SDL2 glew32 opengl32 physfs)
    else()
        set(LIBS SDL2 glew GL physfs)
    endif()

    add_executable(${GAME_NAME} ${SOURCE_LIST} ${MISC_LIST})
    target_link_libraries(${GAME_NAME} ${LIBS})
endif()

if(BUILD_TOOLS)
    file(GLOB_RECURSE SOURCE_LIST "Tools/*.cpp" "Tools/*.h")
    file(GLOB_RECURSE UI_LIST "Tools/*.ui")
    include_directories("Source" "Tools")

    set(CMAKE_INCLUDE_CURRENT_DIR ON)
    set(CMAKE_AUTOMOC ON)
    find_package(Qt5Widgets)
    find_package(Qt5OpenGL)
    qt5_wrap_ui(UI_HEADERS ${UI_LIST})

    add_executable(${TOOLS_NAME} ${SOURCE_LIST} ${UI_LIST})
    qt5_use_modules(${TOOLS_NAME} Widgets OpenGL)
    target_link_libraries(${TOOLS_NAME} opengl32)
endif()
